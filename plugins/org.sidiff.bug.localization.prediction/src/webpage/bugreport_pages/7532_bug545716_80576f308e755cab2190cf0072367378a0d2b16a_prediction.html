<html>

<style>
html{
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif ;
    font-size: 17px;
    display: table;
}
table,th,td {
  border: 1px solid black;
  width: 1200;
  text-align:justify;
  word-break:break-all;
}

th{
background-color: lightskyblue;
font-size: 16px;
border: none;
text-align:left;
}

td{
background-color: #d5e3c8;
font-size: 14px;
}

.container {
  position: relative;
  text-align:center;
  padding-top: 70%;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: 2px solid #73AD21;
}

</style>
<body>

<h2>Bug report Information</h2>
<table>

    <th colspan="2"> Bug Report </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bug Report Number </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 545716 </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Summary </td>
        <td  style="width: 80%; background-color:#f7fff0;"> [12] expression switch doesn't consider that having all cases of an enum is enough to be exhaustive </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Creation Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2019-03-24T17:47:58Z </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Status </td>
        <td  style="width: 80%; background-color:#f7fff0;"> VERIFIED </td>
    </tr>

    <th colspan="2"> Bug Fix </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bugfix Commit </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Bug 545715 - [12] Assignment analysis doesn't work in switch statement
with -> </td>
    </tr>
    <tr>
        <td  tyle="width: 20%; background-color:#d5e3c8;"> Bugfix Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2019-04-08T06:43:20Z </td>
    </tr>
    </table>
<table>

<th colspan="2"> Ranked List of Class Diagrams </th>

<tr>
<td  style="width: 20%; font-size: 10px; background-color:#d5e3c8">

            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> GenericsRegressionTest_9; </a> </li>
            </ul>   
            
            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SwitchExpression; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverterBugsTestJLS8; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RunCompilerTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AptConfig$ProcessorOptionsParser; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FormatterRegressionTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ImplicitNullAnnotationVerifier; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavadocParser; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ResolvedLambdaExpression; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ToolFactory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleBuilderTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Checks; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Compiler; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Factory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFileToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> LambdaExpressionSyntaxTest; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BindingMap; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FilerTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RawGrowableArray; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTRewritingExpressionsTest; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractRegressionTest$JavacTestOptions$MismatchType; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RawGrowableArray; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractRegressionTest$JavacCompiler; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BatchCompiler; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ReadAnnotationTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilerToolTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SelectionOnReferenceExpression; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> UnconditionalFlowInfo; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> NonNullDefaultAwareTypeAnnotationWalker; </a> </li>
            </ul>   
            
</td>
<td  rowspan="30" style="width: 80%;  background-color:#d5e3c8"> 
    <div class="container">
    <iframe class="responsive-iframe" src="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" name="myIframe">
        <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html">SELFHTML</a>
    </iframe>
    </div>
</td>
</tr>
</table>
<table>

<th colspan="2"> Ranked List of Classifiers </th>

                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_9; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; font-weight: bold; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/SwitchExpressionTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; font-weight: bold; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/SwitchExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/CompilerInvocationTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunCompilerTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_1_7; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterAST4Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.apt.core/Lorg/eclipse/jdt/apt/core/util/AptConfig$ProcessorOptionsParser; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/formatter/FormatterRegressionTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/lookup/ImplicitNullAnnotationVerifier; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/parser/JavadocParser; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter17Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterJavadocTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/ResolvedLambdaExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_1_8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTVisitorTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/IPolyExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; font-weight: bold; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/SwitchStatement; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/JavadocArgumentExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/formatter/FormatterBugsTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS3; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/LambdaExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/ToolFactory; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/NullAnnotationTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/ModuleBuilderTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.annotation/Lorg/eclipse/jdt/annotation/Checks; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/JEP323VarLambdaParamsTest; </td>
                </tr>

                </table>
<table>

<th colspan="2"> Discussion </th>

        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-03-24T17:47:58Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Even if a switch expression has a case for each enum values,
it doesn't compile.

enum MyEnum {
    X, Y;
     
    @SuppressWarnings("preview")
    public static void main(String[] args) {
         MyEnum myEnum = MyEnum.X;
         int o;
         switch(myEnum) {
             case X -> o = 5;
             case Y -> o = 10;
             // default should not be needed here,
             // the spec says the compiler will add a default -> throw ...
         }
         System.out.println(o);
     }
}

Note: this codes doesn't work with javac too. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-03-24T18:05:35Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> In fact, the previous example is Ok because it's a switch statement,
but this one which uses a switch expression doesn't work.

enum MyEnum {
    X, Y;
     
    @SuppressWarnings("preview")
    public static void main(String[] args) {
         MyEnum myEnum = MyEnum.X;
         int o;
         var f = switch(myEnum) {
             case X -> o = 5;
             case Y -> o = 10;
             // default should not be needed here,
             // the spec says the compiler will add a default -> throw ...
         };
         System.out.println(o);
     }
} </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-03-26T10:47:24Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Mentioning of "throw" is only within 15.28.2 ("Run-Time Evaluation of switch Expressions"), which specifically requires a IncompatibleClassChangeError.

The relevant part for flow analysis is a difference between 16.2.9 (definite assignment for switch statements) and 16.1.8 (definite assignment for non-boolean switch expressions):

The former explicitly defines:
"Either there is a default label in the switch block or V is [un]assigned after the switch expression."

The corresponding section for switch expressions does *not* mention "default". </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-08T13:54:35Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/140217 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-08T15:06:29Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/140217 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=e726626e8993c67caac2b8e36af66902248ae6a8 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-08T15:54:25Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/140229 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-08T15:54:55Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #5)
> New Gerrit change created: https://git.eclipse.org/r/140229

Cherry-picking to BETA_JAVA_12 branch for further P-builds </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-09T06:26:21Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #4)
> Gerrit change https://git.eclipse.org/r/140217 was merged to [master].
> Commit:
> http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=e726626e8993c67caac2b8e36af66902248ae6a8
> 

Manoj, just curious about the choice of a new method checkNullDefaultFlow(). Could we have done with a simply check of !switchLabeledRules? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-09T06:27:48Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Verified for 4.12 M1 using build I20190408-1800 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-09T07:41:57Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #7)
> (In reply to Eclipse Genie from comment #4)
> > Gerrit change https://git.eclipse.org/r/140217 was merged to [master].
> > Commit:
> > http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=e726626e8993c67caac2b8e36af66902248ae6a8
> > 
> 
> Manoj, just curious about the choice of a new method checkNullDefaultFlow().
> Could we have done with a simply check of !switchLabeledRules?

Also that method's name could be misleading: Is it about null analysis? Perhaps about @NonNonByDefault? :) 
Would it be correct to say: "needToCheckFlowInAbsenceOfDefaultBranch"? Or: "isDefaultCaseRequired"? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-09T08:12:13Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> reopening to work on the last two comments </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-09T10:46:28Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #9)

> Would it be correct to say: "needToCheckFlowInAbsenceOfDefaultBranch"? Or:
> "isDefaultCaseRequired"?


Sure Stephan.. Will do. 

(In reply to Stephan Herrmann from comment #2)

The rule mentioned above in comment 2, I believe doesn't apply in this case because the examples consists of switch labeled rules only and the former applies to switch labeled statement group.

So I feel the correct rule should be from the second para of 16.2.9 for switch statement:

The following rules apply only if the switch block of the switch statement consists of switch labeled rules:
V is [un]assigned after a switch statement iff for every switch labeled rule one of the following is true:

...
It is a switch labeled block b and either V is [un]assigned after e or V is [un]assigned before every break statement contained in b that may exit the switch statement.
...

And similarly for Switch expression, section 16.1.8 second para applies rather than the first para,
The following rules apply only if the switch block of a switch expression consists of switch labeled rules:

V is definitely assigned after a switch expression iff for every switch labeled rule one of the following is true:

...
It is a switch labeled block b and for every value break statement expression e contained in b that may exit the switch expression, either V is definitely assigned before the value break statement or V is definitely assigned after e.
...

Hence, I believe the error should be flagged in both the cases.
@Stephan: can you please comment? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-12T16:00:47Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #11)
> Hence, I believe the error should be flagged in both the cases.
> @Stephan: can you please comment?

I admit that I didn't pay attention to the detailed form of the switch, but I don't see how any of the rules you cite requires to reject the given examples. Please explain. In particular, I'd expect any reasoning to contain the word 'default', because that's the subject of this bug. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-16T06:57:09Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #12)
> (In reply to Manoj Palat from comment #11)
> > Hence, I believe the error should be flagged in both the cases.
> > @Stephan: can you please comment?
> 

> examples. Please explain. In particular, I'd expect any reasoning to contain
> the word 'default', because that's the subject of this bug.
@Stephan: 
First of all, my bad - the conclusion that there should be an error was wrong; It should have been exactly the opposite, there should NOT be an error in both cases. Essentially, the point was there should not be any difference either in case of Switch Statement [comment 0] or Switch Expression[comment 1] .
The logic is this, please correct if you find holes here - Section 16.2.9, http://cr.openjdk.java.net/~gbierman/switch-expressions.html#jep325-16.2.9, para 1, says: The following rules apply only if the switch block of a switch statement (14.11) is empty, consists of just switch labels, or consists of switch labeled statement groups:
..
Default with a �:�, ie �default :� definitely comes under the preview of the above. However, Since �default ->� comes under switch labeled expression, and not under switch labeled statement group, the rules cited under that para does not apply to �default ->�.  Hence, what applies is the last para, under �The following rules apply only if the switch block of the switch statement consists of switch labeled rules:�
V is [un]assigned after a switch statement iff for every switch labeled rule one of the following is true:
-It is a switch labeled expression e and either V is [un]assigned after e or after the selector expression.
..
Using the first item in the  list � ie  For every switch labeled rule, v is assigned after e � it can be concluded that there should NOT be an error for the �default� case for Switch labeled rules in Switch statement, even though the �default� is not mentioned explicitly.
For a switch expression also, http://cr.openjdk.java.net/~gbierman/switch-expressions.html#jep325-16.1.8, the rules are similar and there is no mention of �default� in either cases. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-16T06:59:52Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #13)

> Using the first item in the  list � ie  For every switch labeled rule, v is
> assigned after e � it can be concluded that there should NOT be an error for
> the �default� case for Switch labeled rules in Switch statement, even though

ie v is definitely assigned after the switch statement and hence there should be any error flagged in the subsequent uses of v [which is "o" here]. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-16T07:04:06Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #14)
> (In reply to Manoj Palat from comment #13)
> 
> ie v is definitely assigned after the switch statement and hence there
> should be any error flagged in the subsequent uses of v [which is "o" here].

Essentially, to list out my conclusion:

1) Agree that definite analysis for Switch expression will find "o" to be definitely assigned.

2) Do not agree that there is a difference for Switch statement due to the reasons cited in comment 13

@Stephan: Please let know if we are in the same page here. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-16T08:58:11Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #14)
> (In reply to Manoj Palat from comment #13)
> 
> > Using the first item in the  list � ie  For every switch labeled rule, v is
> > assigned after e � it can be concluded that there should NOT be an error for
> > the �default� case for Switch labeled rules in Switch statement, even though
> 
> ie v is definitely assigned after the switch statement and hence there
> should be any error flagged in the subsequent uses of v [which is "o" here].

insert "not" after "should" and I'll agree.

(In reply to Manoj Palat from comment #15)
> Essentially, to list out my conclusion:
> 
> 1) Agree that definite analysis for Switch expression will find "o" to be
> definitely assigned.
> 
> 2) Do not agree that there is a difference for Switch statement due to the
> reasons cited in comment 13
> 
> @Stephan: Please let know if we are in the same page here.

Now the story is taking an interesting turn.

For switch expressions we don't have to worry about default *because* according to 15.28.1 absence of default implies that all enum constants are covered. For those we agree that: (a) throw should be generated, (b) definite assignment is given.

For switch statements with switch labeled rules 16.2.9 also suggests to ignore presence/absence of default, but JLS provides no foundation for this to be sound. What should a compiler now do with the following?

enum MyEnum {
    X, Y;
     
    @SuppressWarnings("preview")
    public static void main(String[] args) {
         MyEnum myEnum = MyEnum.X;
         int o;
         switch(myEnum) {
             case Y -> o = 5;
             // neither "case X" nor default
         }
         System.out.println(o);
     }
}

I no longer see any rule that would let us reject this program.

Ergo: what started as a bug in ecj, according to current understanding turns out to be bugs in all three entities: JLS, javac & ecj.

javac incorrectly rejects comment 0 (and hence rejects the new example for a bogus reason).

JLS admits obviously incorrect code in this comment.

=> not much guidance, what exactly ecj should implement.

Am I missing anything?

If Rémi is still listening, maybe he likes to comment? Which rule makes the latest example here illegal? If there is such, does it also apply to comment 0? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-17T04:37:50Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #16)
> insert "not" after "should" and I'll agree.
Oh yes.. that was a typo as evident from the rest of the test. 
To be read as �and hence there should not be any error flagged in the subsequent uses of v [which is "o" here].�

> (In reply to Manoj Palat from comment #15)
> For switch expressions we don't have to worry about default *because*
> according to 15.28.1 absence of default implies that all enum constants are
> covered. For those we agree that: (a) throw should be generated, (b)
> definite assignment is given.
> 
Yes. Although it would have been good to have the spec lay it out in one single place for the def assigned analysis.
> For switch statements with switch labeled rules 16.2.9 also suggests to
> ignore presence/absence of default, but JLS provides no foundation for this
> to be sound. What should a compiler now do with the following?
> 
> I no longer see any rule that would let us reject this program.
> 
> Ergo: what started as a bug in ecj, according to current understanding turns
> out to be bugs in all three entities: JLS, javac & ecj.
Yep. Agree.
> javac incorrectly rejects comment 0 (and hence rejects the new example for a
> bogus reason).
> 
> JLS admits obviously incorrect code in this comment.
> 
> => not much guidance, what exactly ecj should implement.
> 
> Am I missing anything?
No, I don�t think so; Because checking from JLS 12, 14.11, �A Java compiler is encouraged (but not required) to provide a warning if a switch on an enum-valued expression lacks a default label and lacks case labels for one or more of
the enum's constants. Such a switch will silently do nothing if the expression evaluates
to one of the missing constants.�; - [ this is an existing rule, nothing new in JLS 12]. Given that the spec allows such a construct with just an optional warning, the definite analysis part of spec needs to talk about this case which is missed out.
Maybe it�s the right time to ask in the mailing list � Alex has asked for feedback here: https://mail.openjdk.java.net/pipermail/jdk-dev/2019-April/002770.html </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-25T06:05:28Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #17)
Reply awaited for https://mail.openjdk.java.net/pipermail/jdk-dev/2019-April/002779.html </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-25T13:12:28Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> If this code is legal, I'll provide a patch to fix it. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-26T08:29:16Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Olivier Thomann from comment #19)
> If this code is legal, I'll provide a patch to fix it.

@Olivier: With the commit in current 4, we accept the code in comment 1 as legal already. Once the feedback is received and if it confirms that the code in comment 0 is legal, it is just a matter of moving the method from SwitchExpressions to SwitchStatement - nothing much to do here in that case as well. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-26T08:30:09Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/141202 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-26T09:03:04Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/141202 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=8d7a3b6518962ae563556185a4be8fc8517bf0f4 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-30T09:38:49Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #18)
> (In reply to Manoj Palat from comment #17)
> Reply awaited for
> https://mail.openjdk.java.net/pipermail/jdk-dev/2019-April/002779.html

Reply received - reproduced below:
Alex Buckley alex.buckley at oracle.com 
Mon Apr 29 20:46:41 UTC 2019
Previous message: Call for feedback -- switch expressions in JDK 12
Next message: jdk-submit maintenance April 26 - 28, 2019
Messages sorted by: [ date ] [ thread ] [ subject ] [ author ]
On 4/17/2019 4:50 PM, Manoj Palat wrote:
>     2) Thanks to Remi Forax raising a bug in ecj
>     [https://bugs.eclipse.org/bugs/show_bug.cgi?id=545716] and the
>     following discussions, we believe that there could be a bug [in
>     spec, javac as well as ecj] � see this comment from Stephan Herrmann
>     _https://bugs.eclipse.org/bugs/show_bug.cgi?id=545716#c16_specifically
>     for the findings.

Thanks for raising this. There is a flaw in how the new JLS 16.2.9 
analyzes -> rules in a switch statement 
(http://cr.openjdk.java.net/~gbierman/switch-expressions.html#jep325-16.2.9). 
The flaw is due to the fact that -> rules were initially introduced in 
switch expressions, which are complete by construction. (Either there is 
an explicit default, or there is an implicit default to catch novel enum 
constants.)

We will publish a new spec for JEP 354 soon, but in the meantime here is 
the corrected part of 16.2.9:

-----
The following rules apply only if the switch block of the switch 
statement consists of switch labeled rules:

* V is assigned after a switch statement iff either of the following are 
true:

     V is assigned after the selector expression, or

     There is a default labeled rule and for every switch labeled rule 
one of the following is true:

         It is a switch labeled expression e and V is assigned after e.

         It is a switch labeled block b and both V is assigned after b 
and V is assigned before every break statement contained in b that may 
exit the switch statement.

         It is a switch labeled throw statement.

* V is unassigned after a switch statement iff both of the following 
rules are true:

     V is unassigned after the selector expression, and

     For every switch labeled rule one of the following is true:

         It is a switch labeled expression e and V is unassigned after e.

         It is a switch labeled block b and both V is unassigned after b 
and V is unassigned before every break statement contained in b that may 
exit the switch statement.

         It is a switch labeled throw statement.

* V is [un]assigned before any switch labeled expression, switch labeled 
block, or switch labeled throw statement iff V is [un]assigned after the 
selector expression.
-----

Alex </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-04-30T10:10:08Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Given the expected spec changes in comment 23, the code in comment 0 should not compile because:
V is not definitely assigned because a) not assigned after selector expression and b) there is no default conditions being false.
V is not definitely unassigned because the second condition is false [ It is a switch labeled expression e (true) and V is unassigned after e.(false)].

Hence v is potentially uninitialized; the error is flagged. With this change in specs both javac and ecj exhibit correct behavior for a �switch statement� with �switch labeled rule� by flagging the error.

Given the above, no further changes expected in this bug.
@Stephan: Any further comments? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-05-20T08:06:21Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Need to recheck with the latest Java 13 Switch Expression JEP - Moving to 4.13 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-05-20T22:06:08Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #25)
> Moving to 4.13

Which did you mean? 4.13 or 4.11+ ? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-05-21T04:30:12Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #26)
> (In reply to Manoj Palat from comment #25)
> > Moving to 4.13
> 
> Which did you mean? 4.13 or 4.11+ ?

Oops... Thanks for pointing out - 4.13 -perils of bulk processing :( </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-07-18T09:30:51Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Ref the spec as of now: http://cr.openjdk.java.net/~gbierman/jep354-jls-20190528.html - no change required - resolving. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-07-28T21:14:28Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> FYI: I filed bug 549614 to be able to run our tests with comparison against javac. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-07-29T08:23:22Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #29)
> FYI: I filed bug 549614 to be able to run our tests with comparison against
> javac.

@Manoj, after bug 549614 we are now able to run this test against javac, which currently fails. Please double check and add an appropriate Excuse. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-12T08:05:29Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #30)
> (In reply to Stephan Herrmann from comment #29)
> > FYI: I filed bug 549614 to be able to run our tests with comparison against
> > javac.
> 
> @Manoj, after bug 549614 we are now able to run this test against javac,
> which currently fails. Please double check and add an appropriate Excuse.

@Stephan: I don't see the failure here - code in comment 0 throws an error both in ecj and javac while code in comment 1 passes in both ecj and javac. Am I missing any case here? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-13T10:33:03Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #31)

> @Stephan: I don't see the failure here - code in comment 0 throws an error
> both in ecj and javac while code in comment 1 passes in both ecj and javac.
> Am I missing any case here?

Please ignore the above comment - reproduced. I was looking at Java 13 preview part in the IDE rather than master - will take a look. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-14T05:09:26Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/147666 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-14T05:14:01Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #33)
> New Gerrit change created: https://git.eclipse.org/r/147666

Patch addresses the following
(1) testBug545716_01 (earlier testBug545916_01 incorrect name) - JavacBug8221413
(2) testBug545333 also addressed with JavacBug8226510

Please note that both 8221413 and 8226510 are fixed in Java 13 and hence these excuses need not go to BETA_JAVA13 branch </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-14T06:24:24Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/147666 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=bed796f498b19027a8ec3a769f0d1da3ce0c4807 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-22T03:57:27Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Verified for 4.13 M3 using build I20190820-1800 </td> </tr>
        </table>
</body>
</html>
