<html>

<style>
html{
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif ;
    font-size: 17px;
    display: table;
}
table,th,td {
  border: 1px solid black;
  width: 1200;
  text-align:justify;
  word-break:break-all;
}

th{
background-color: lightskyblue;
font-size: 16px;
border: none;
text-align:left;
}

td{
background-color: #d5e3c8;
font-size: 14px;
}

.container {
  position: relative;
  text-align:center;
  padding-top: 70%;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: 2px solid #73AD21;
}

</style>
<body>

<h2>Bug report Information</h2>
<table>

    <th colspan="2"> Bug Report </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bug Report Number </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 562044 </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Summary </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Simplify generating the parser </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Creation Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2020-04-12T12:39:21Z </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Status </td>
        <td  style="width: 80%; background-color:#f7fff0;"> VERIFIED </td>
    </tr>

    <th colspan="2"> Bug Fix </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bugfix Commit </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Bug 562198 - [14] Switch Expression - CCE in switch expression with
yield array access

Change-Id: Id55242e9f61c33d8b7596f9a7b796c85e3640254
 </td>
    </tr>
    <tr>
        <td  tyle="width: 20%; background-color:#d5e3c8;"> Bugfix Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2020-04-16T07:53:42Z </td>
    </tr>
    </table>
<table>

<th colspan="2"> Ranked List of Class Diagrams </th>

<tr>
<td  style="width: 20%; font-size: 10px; background-color:#d5e3c8">

            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> DatabaseRef; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> GenericsRegressionTest_1_8; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter9Test; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RunCompilerTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractRegressionTest$JavacCompiler; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFile; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ConstraintExpressionFormula; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavaSearchJavadocTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ReconcileFilerImpl; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilerToolTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> IDOMFactory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTRewrite; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SwitchExpression; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavaModelManager; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BindingToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JDTCompilerAdapter; </a> </li>
            </ul>   
            
            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Parser; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Main; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Chunk; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilerToolJava9Tests$CompilerBuilder; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Util; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClasspathUtil; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleInfoBuilder; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFileToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> TokenManager; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleUtil$ModuleAccumulatorEnvironment; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Factory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Database; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModelTests; </a> </li>
            </ul>   
            
</td>
<td  rowspan="30" style="width: 80%;  background-color:#d5e3c8"> 
    <div class="container">
    <iframe class="responsive-iframe" src="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" name="myIframe">
        <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html">SELFHTML</a>
    </iframe>
    </div>
</td>
</tr>
</table>
<table>

<th colspan="2"> Ranked List of Classifiers </th>

                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/nd/DatabaseRef; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/dom/ASTConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_1_8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter9Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunCompilerTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/AbstractRegressionTest$JavacCompiler; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ClassFile; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/lookup/ConstraintExpressionFormula; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaSearchJavadocTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_9; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.apt.core/Lorg/eclipse/jdt/apt/core/internal/env/ReconcileFilerImpl; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/Compiler; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.compiler.tool.tests/Lorg/eclipse/jdt/compiler/tool/tests/CompilerToolTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/jdom/IDOMFactory; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/dom/rewrite/ASTRewrite; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter18Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/SwitchExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter10Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/JavaModelManager; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/indexer/BindingToIndexConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/JDTCompilerAdapter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/lookup/SourceTypeBinding; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/LambdaRegressionTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/NullReferenceImplTests~Generator; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/JavaProject; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/indexer/ClassFileToIndexConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; font-weight: bold; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/parser/Parser; </td>
                </tr>

                </table>
<table>

<th colspan="2"> Discussion </th>

        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-12T12:39:21Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> It would be nice if the manual procedure described at https://www.eclipse.org/jdt/core/howto/generate%20parser/generateParser.html could be turned into a pushbutton procedure.

In fact, I have written such a script (in the form of a Java class org.eclipse.jdt.internal.compiler.parser.GenerateParserScript with a main method); see the Gerrit change I will be adding to this bug presently.

I did decide to add some comments to Parser.java, ParserBasicInformation.java, and TerminalTokens.java to delimit the autogenerated parts; I hope that's fine.

Note: when I run this script on the current HEAD, I get a different parser21.rsc; I assume the committed parser21.rsc is out of date with respect to the source code. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-12T12:46:12Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change: https://git.eclipse.org/r/160810 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-12T15:13:53Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I confirmed that the version of parser21.rsc at HEAD is out of sync with java.g at HEAD. I confirmed that, more specifically, it still assigns compliance level 0 to the JDK 14 rules (mostly involving records) instead of compliance level 14. (I confirmed that this is the only difference.)

My Gerrit change causes some tests to fail. At least one of these tests seems incorrect: https://git.eclipse.org/c/jdt/eclipse.jdt.core.git/tree/org.eclipse.jdt.core.tests.compiler/src/org/eclipse/jdt/core/tests/compiler/parser/ComplianceDiagnoseTest.java#n2461 seems to assert that an error message involving records should be generated at compliance level 1.5 and up, which seems wrong.

Perhaps we should try to add an automatic check to the build process that causes the build to fail if the autogenerated (parts of) files are out of sync with java.g. This could be done (without the need for everyone to have jikespg installed) by including a hash of java.g into the autogenerated files.

If people can confirm that they would be open to that, I can try to code up such a check. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-12T18:23:02Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> On further thought: a more thorough solution would be to
1) check Windows, macOS, and Linux/x64 binaries of jikespg (plus perhaps the C sources of jikespg) into the eclipse.jdt.core repository, and
2) separate the autogenerated part of Parser.java out into a separate file, and
3) delete the autogenerated files from the repo and add them to .gitignore, and
4) add generating the parser as a Builder to the project.

Are people open to that? If so, I can give it a try.

If licensing issues prevent us from checking jikespg into the repo, we could instead automatically download it as part of the build. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T05:33:58Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #2)
> My Gerrit change causes some tests to fail. At least one of these tests
> seems incorrect:
> https://git.eclipse.org/c/jdt/eclipse.jdt.core.git/tree/org.eclipse.jdt.core.
> tests.compiler/src/org/eclipse/jdt/core/tests/compiler/parser/
> ComplianceDiagnoseTest.java#n2461 seems to assert that an error message
> involving records should be generated at compliance level 1.5 and up, which
> seems wrong.
Yes, this is wrong, you can update with the correct error message - I think a fallout of "correcting" the test cases with the compliance level issue.

> Perhaps we should try to add an automatic check to the build process that
> causes the build to fail if the autogenerated (parts of) files are out of
> sync with java.g. This could be done (without the need for everyone to have
> jikespg installed) by including a hash of java.g into the autogenerated
> files.

I think it is a good suggestion. Thanks Bert! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T05:44:52Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #3)
My two cents:
> On further thought: a more thorough solution would be to
> 1) check Windows, macOS, and Linux/x64 binaries of jikespg (plus perhaps the
> C sources of jikespg) into the eclipse.jdt.core repository, and

I think keeping a binary in the repo is something we would like to avoid if possible.
And am not sure whether its a good idea to checkin the C sources of jikespg - I know that you are aware of the Dave Shield's repo at https://github.com/daveshields/jikespg - I would think its better we contribute there rather. 

> 2) separate the autogenerated part of Parser.java out into a separate file,

Yes, for the switch() statement in the consumeRule() of the generated states; No, to the various consumeXXx() functions in mind, then this would be a problem because the inherited classes (AssistParser, SelectionParser etc) changes some of these methods

> and
> 3) delete the autogenerated files from the repo and add them to .gitignore,
> and
> 4) add generating the parser as a Builder to the project.
> 
> Are people open to that? If so, I can give it a try.
> 
> If licensing issues prevent us from checking jikespg into the repo, we could
> instead automatically download it as part of the build.
For this, I would go for downloading option rather than keeping the source of jikespg in eclipse.jdt. repo. Part of the build -> Here I believe you mean building/downloading when only java.g changes, rt?

@Stephan: Any comments from your side? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T10:34:52Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Trying to catch up while mail.eclipse.org is not delivering (bug 561981).

Yes, parser21.rsc in git is not the same as I get from jikespg.

Yes, if I run tests with updated parser21.rsc I see the same as Bart describes in comment 2. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T11:11:27Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #0)
> It would be nice if the manual procedure described at
> https://www.eclipse.org/jdt/core/howto/generate%20parser/generateParser.html
> could be turned into a pushbutton procedure.
> 
> In fact, I have written such a script (in the form of a Java class
> org.eclipse.jdt.internal.compiler.parser.GenerateParserScript with a main
> method); see the Gerrit change I will be adding to this bug presently.

I personally have been using a similar script in the form of a bash script for many years [1]. While it perfectly does it's job, it's of course limited to unix platforms.

So, yes, also from my side: having this as a Java program is highly appreciated.

[1] https://git.eclipse.org/c/objectteams/org.eclipse.objectteams.git/tree/org.eclipse.jdt.core/scripts/generateOTParser.sh </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T11:44:00Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I moved that part concerning parser21.rsc and bogus test expectations to bug 562057. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T12:10:45Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/160810 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T13:10:01Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #5)
> And am not sure whether its a good idea to checkin the C sources of jikespg
> - I know that you are aware of the Dave Shield's repo at
> https://github.com/daveshields/jikespg - I would think its better we
> contribute there rather. 

My impression is that Dave is not maintaining that repo anymore. There has been no reaction yet to my pull request from Aug 2018, which simply proposes to accept the downstream patches done by the Ubuntu package maintainers. (I suspect the Ubuntu package is the version that you guys are using, and not the one on SourceForge that the JDT Core Development Resources point to, because the Ubuntu package fixes some important bugs.)

So, I think that effectively, jikespg currently has no maintainer. I think it would make most sense if JDT Core took over its maintenance. Does it even have any other users? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T13:36:31Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #10)

> So, I think that effectively, jikespg currently has no maintainer. I think
> it would make most sense if JDT Core took over its maintenance. Does it even
> have any other users?

I agree it makes logical sense for us to own - However, I am not sure about the IP issues here, if any - so I am CCing Dani and Pradeep to get an opinion. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T14:11:50Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #11)
> (In reply to Bart Jacobs from comment #10)
> 
> > So, I think that effectively, jikespg currently has no maintainer. I think
> > it would make most sense if JDT Core took over its maintenance. Does it even
> > have any other users?
> 
> I agree it makes logical sense for us to own - However, I am not sure about
> the IP issues here, if any - so I am CCing Dani and Pradeep to get an
> opinion.
I doubt that the license allows to just "take over". The current owner would have to move it to Eclipse, but not under JDT, as it is also useful for C and C++. Technology seems to be the right parent/classification. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T14:18:48Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Dani Megert from comment #12)
> I doubt that the license allows to just "take over". The current owner would
> have to move it to Eclipse

Please note https://github.com/daveshields/jikespg , where co-author Dave Shields seems to be putting JikesPG under the IBM Public License.

My understanding is that JikesPG was created by Philippe Charles and Dave Shields as part of their job at IBM. Do any of the current IBM people have any bandwidth with either of the authors? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T14:47:46Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #10)
> My impression is that Dave is not maintaining that repo anymore. There has
> been no reaction yet to my pull request from Aug 2018, which simply proposes
> to accept the downstream patches done by the Ubuntu package maintainers. (I
> suspect the Ubuntu package is the version that you guys are using, and not
> the one on SourceForge that the JDT Core Development Resources point to,
> because the Ubuntu package fixes some important bugs.)

I'm not aware of that ubuntu package (although running on ubuntu myself). Instead I have my own bug fixes in a local git repo. Can you provide a link to the repo used at ubuntu, so I can compare their fixes to mine? My corrections mostly concerned memory corruption, but also one logical bug. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-13T16:16:40Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #14)
> I'm not aware of that ubuntu package (although running on ubuntu myself).
> Instead I have my own bug fixes in a local git repo. Can you provide a link
> to the repo used at ubuntu, so I can compare their fixes to mine? My
> corrections mostly concerned memory corruption, but also one logical bug.

See https://bazaar.launchpad.net/~ubuntu-branches/ubuntu/trusty/jikespg/trusty/files/head:/debian/patches .

(I copied these patches into my pull request which is at https://github.com/daveshields/jikespg/pull/1 .)

I also did some additional tweaks myself; see https://github.com/btj/jikespg/commits/btj . It's high time this package got a proper home! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-15T15:37:04Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I checked on the IBMers mentioned in this bug and they are gone.

The best solution is to contribute directly to jikespg. Moving this to Eclipse would be too much work.

Interested parties, please follow that path. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-15T16:56:08Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Dani Megert from comment #16)
> I checked on the IBMers mentioned in this bug and they are gone.
> 
> The best solution is to contribute directly to jikespg. Moving this to
> Eclipse would be too much work.
> 
> Interested parties, please follow that path.

Since jikespg currently seems to be abandonware with no active maintainer, I created a GitHub org and forked Dave Shields' repo into it: https://github.com/jikespg/jikespg . I sent invites to the people in this thread to be co-owners of the org.

The goal would be to have this be the version that everyone uses. I intend to have Travis generate binaries, that one could then automatically download as part of an automated build process for eclipse.jdt.core. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-15T18:51:56Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #17)
> (In reply to Dani Megert from comment #16)
> > I checked on the IBMers mentioned in this bug and they are gone.
> > 
> > The best solution is to contribute directly to jikespg. Moving this to
> > Eclipse would be too much work.
> > 
> > Interested parties, please follow that path.
> 
> Since jikespg currently seems to be abandonware with no active maintainer, I
> created a GitHub org and forked Dave Shields' repo into it:
> https://github.com/jikespg/jikespg . I sent invites to the people in this
> thread to be co-owners of the org.
> 
> The goal would be to have this be the version that everyone uses. I intend
> to have Travis generate binaries, that one could then automatically download
> as part of an automated build process for eclipse.jdt.core.

Thanks. I just pushed my existing changes into branch fixes-sherrmann. This is the version that I have been using whenever I re-generated the parser over the years (since 2013 to be precise). Those may not be perfect, but with them jikespg works without buffer overflows or such ;p

Please suggest, how to combine the various fixes from various sources. E.g., I saw that ubuntu replaces strcpy with memmove, while I mapped it (using a macro) to bcopy. Removing the optimization -O1 is done purely heuristically, after I noticed that I had buffer overflows with optimization (just verified this a minute ago), which does not occur without it.

I must admit, I don't normally work on github, so I may need a little hand holding once it comes to pull requests & merging :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-16T08:13:05Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> In the meantime, I think https://git.eclipse.org/r/160810 is now ready to be merged. Once it is merged, it will be easier for me to submit a Gerrit change for bug 561934. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-16T19:59:46Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> BTW, what do people think about separating hand coded and generated parts of Parser? Wouldn't that make maintenance easier?

I'm thinking of renaming Parser into InternalParser and generating a new "Parser extends InternalParser" with only the consumeRule() method. In the history of a manually maintained class I don't really want to see all the changes from the generator. And cutting this huge class into two would also improve the editing experience :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-16T21:12:32Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #19)
> In the meantime, I think https://git.eclipse.org/r/160810 is now ready to be
> merged. Once it is merged, it will be easier for me to submit a Gerrit
> change for bug 561934.

I like it.

Still I proposed a few changes (patch set #3)

- first I moved the "script" out of the main source tree, because we don't want
  to include this class in our deliverables.

- since now it's no longer automatically built, I added a tiny ant script
  to compile and launch the program plus a .launch file (which also performs
  a refresh after running).

- I modified the mechanism for passing JIKESPG: users now have to define
  a per-workspace String Substitution, which will then be passed as a system
  property into the program. This way, the .launch remains platform independent.
  (see build-parser.xml for usage hints)


Then I made some small changes to the program itself:

- add copyright notice :)

- add an early exit(1) if the grammar is not good.

- remove trailing whitespace from generated code.


At this point running the .launch regenerated all files with no changes :)

Adding a bug into java.g lets the program abort, at which points java.l and friends will stay for debugging purposes.


Any objections to any of the changes? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-17T05:50:22Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #21)
Thanks Stephan and Bart; And no objections, Stephan. btw, I compared with the script what we use and did not find anything to be added. However, one practical issue I had was that jikespg when compiled on Mac was dumping - Didn't get a chance to debug (Stephan and I did exchange notes on the same sometime earlier) - So what I use is to generate the files in a Ubuntu VM and transfer the files to my local Mac - Not a smart thing to do, but it works. In such cases, I would like to have one more entry point (maybe a boolean param) for GenerateScript where-in I can specify whether I need to run JIKESPG or not - if not, I would have already run jikespg manually and  copied these files in the grammar folder - essentially an escape mechanism - WDYT? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-17T07:22:46Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Manoj Palat from comment #22) boolean param) for GenerateScript where-in I can specify whether I need to
> run JIKESPG or not - if not, I would have already run jikespg manually and 
> copied these files in the grammar folder - essentially an escape mechanism -

Added this minor change in patchset 4 - decision based on a magic string of "JIKESPG_EXTERNAL" in env </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-17T09:28:32Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Both modifications look great to me! I've tested it and it works! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-17T09:50:29Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Bart Jacobs from comment #24)
> Both modifications look great to me! I've tested it and it works!

Thanks Bart! Submitting the changes </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-17T09:50:52Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/160810 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=30c7385ebc8bdb1713175816d6766d1ba583823a </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-12T19:34:18Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Correction: this was fixed for 4.16 M3 :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-20T11:43:23Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Verified for Eclipse Version: 2020-06 4.16 M3 with Build id: I20200519-1800 </td> </tr>
        </table>
</body>
</html>
