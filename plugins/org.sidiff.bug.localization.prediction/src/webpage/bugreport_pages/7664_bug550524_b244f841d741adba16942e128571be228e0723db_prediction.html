<html>

<style>
html{
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif ;
    font-size: 17px;
    display: table;
}
table,th,td {
  border: 1px solid black;
  width: 1200;
  text-align:justify;
  word-break:break-all;
}

th{
background-color: lightskyblue;
font-size: 16px;
border: none;
text-align:left;
}

td{
background-color: #d5e3c8;
font-size: 14px;
}

.container {
  position: relative;
  text-align:center;
  padding-top: 70%;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: 2px solid #73AD21;
}

</style>
<body>

<h2>Bug report Information</h2>
<table>

    <th colspan="2"> Bug Report </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bug Report Number </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 550524 </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Summary </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Using EE 11 or 12 with JRE 13 and no module-info.java results in compile error (Object not found) </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Creation Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2019-08-28T09:10:07Z </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Status </td>
        <td  style="width: 80%; background-color:#f7fff0;"> VERIFIED </td>
    </tr>

    <th colspan="2"> Bug Fix </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bugfix Commit </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Bug 548456 - Concurrency problem with JavaModelManager and
JavaElement.openWhenClosed()

- add a suite() method to enable running the test during builds!

Change-Id: I78b37950518851c76fa24bbabfdfd8516a9a23b5
 </td>
    </tr>
    <tr>
        <td  tyle="width: 20%; background-color:#d5e3c8;"> Bugfix Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2019-08-29T19:11:00Z </td>
    </tr>
    </table>
<table>

<th colspan="2"> Ranked List of Class Diagrams </th>

<tr>
<td  style="width: 20%; font-size: 10px; background-color:#d5e3c8">

            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleBuilderTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilerToolJava9Tests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleCompilationTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter18Test; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RunCompilerTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> APIDocumentationTests$JavaCoreJavadocAnalyzer; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractRegressionTest$JavacCompiler; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FormatterRegressionTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RecoveredModule; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilationUnitHelper; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CodeFormatterApplication; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> InfrastructureTests; </a> </li>
            </ul>   
            
            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FileSystem; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ToolFactory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> IUpdatableModule; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavaModelAccess; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CommentFormatterUtil; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BTreeExpensiveTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFileToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleInfoBuilder; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FullSourceWorkspaceModelTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> CompilerOptions; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavaProject; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFileToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavaIndexerApplication; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ParserTest; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Util; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> TestUtil; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractLeakTest; </a> </li>
            </ul>   
            
</td>
<td  rowspan="30" style="width: 80%;  background-color:#d5e3c8"> 
    <div class="container">
    <iframe class="responsive-iframe" src="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" name="myIframe">
        <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html">SELFHTML</a>
    </iframe>
    </div>
</td>
</tr>
</table>
<table>

<th colspan="2"> Ranked List of Classifiers </th>

                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/ModuleBuilderTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.compiler.tool.tests/Lorg/eclipse/jdt/compiler/tool/tests/CompilerToolJava9Tests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/ModuleCompilationTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter18Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunCompilerTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaProjectTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter9Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/APIDocumentationTests$JavaCoreJavadocAnalyzer; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterJavadocTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/AbstractRegressionTest$JavacCompiler; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS3; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunOnly335CompilerTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterBugsTestJLS4; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaLikeExtensionsTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaSearchBugsTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaSearchBugs9Tests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/JavaIndexTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/dom/ASTConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/CompilerInvocationTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/formatter/FormatterRegressionTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/parser/RecoveredModule; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/JavadocBugsTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_9; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/GenericsRegressionTest_1_8; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/formatter/FormatterJavadocDontIndentTagsTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.apt.core/Lorg/eclipse/jdt/apt/core/internal/generatedfile/CompilationUnitHelper; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunOnlyJava12Tests; </td>
                </tr>

                </table>
<table>

<th colspan="2"> Discussion </th>

        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T09:10:07Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Using EE 11 or 12 with JRE 13 and no moudle-info.java results in compile error (Object not found)

1. Install I20190827-1800 
2. Start new workspace with Java 13
3. Create a new Java project 'P' BUT: don't create the module-info.java
==> at this point things seem to look good (JRE 13 is bound to EE 12)
4. Create a class 'C'
==> compile errors:

The project was not built since its build path is incomplete. Cannot find the class file for java.lang.Object. Fix the build path then try building this project	P		Unknown	Java Problem

The type java.lang.Object cannot be resolved. It is indirectly referenced from required .class files	C.java	/P/src	line 1	Java Problem </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T09:15:35Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Note: With the module-info.java file it works. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T13:43:54Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> From first glance, looks like the ct.sym has changed once again!!!

In JDK 12, under each specific folder such as A, B, C etc. (i.e, 10, 11, 12), all the module-info.class files were listed. But looking at the JDK 13 EA, we only see a subset of modules. Probably they are listing only the ones that changed?

Investigating further. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T16:18:18Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/148527 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T16:28:50Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #3)
> New Gerrit change created: https://git.eclipse.org/r/148527

Patch might need some cleanup. Will revisit shortly.

At this point, it is impossible to cover these in new unit tests in master since we don't have support for all Java 13 related things. If anyone interested, can do so by running ModuleCompilationTest with JavaSE-12 mapped to JDK 13. Without patch most --release related tests will fail, but with the patch, there would be only three failures, which are due to some releas levels not supported in JDK 13.

In other words, I don't plan to add any new tests to the patch.

The change in FileSystem is already present in BETA_JAVA13 branch, which was part of a larger commit. I think it is good enough to nclude just this particular change for this bug. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-28T22:48:54Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #2)
> From first glance, looks like the ct.sym has changed once again!!!

Is that true?

If so, then this seems to be bigger than a blocker just for 4.13. All Eclipse releases since 4.7.1a need this fix, shippable no later than Java 13 GA, or people will be very frustrated when they have a JRE 13 and try to develop code at any compliance below 13, right?

If you ask me this would warrant a veto against the Java 13 Release.

Also JEP 247 must be re-opened until a *specified* and implementable solution has been found. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T03:12:35Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #5)
> (In reply to Jay Arthanareeswaran from comment #2)
> > From first glance, looks like the ct.sym has changed once again!!!
> 
> Is that true?

A quick comparison of release 11 (B) folder:

JDK 12 GA contains 60 modules
JDK 13 EA contains 8 modules.

May be all those 60 modules weren't touched during 11, but that still doesn't mean they break existing clients.

Even if they are doing the right thing, what must happen is, this being specified somewhere. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T04:09:11Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Mapped Java SE-10 EE to JDK 13 and created a Java Project with Java SE-10 EE without module-info.java works well.
Problem is observed for Java SE-11 and Java SE-12 EE's mapped to JDK 13. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T04:17:44Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Sarika Sinha from comment #7)
> Mapped Java SE-10 EE to JDK 13 and created a Java Project with Java SE-10 EE
> without module-info.java works well.
> Problem is observed for Java SE-11 and Java SE-12 EE's mapped to JDK 13.

That it works with JavaSE-10 is only because the release folder 10 in JDK 13 contains most modules that will be needed normally, for e.g, java.base. Not all of them. If you try using a module that's not present in it directly, it will fail. Can you please test with the patch also? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T05:49:43Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #8)
> (In reply to Sarika Sinha from comment #7)
> > Mapped Java SE-10 EE to JDK 13 and created a Java Project with Java SE-10 EE
> > without module-info.java works well.
> > Problem is observed for Java SE-11 and Java SE-12 EE's mapped to JDK 13.
> 
> That it works with JavaSE-10 is only because the release folder 10 in JDK 13
> contains most modules that will be needed normally, for e.g, java.base. Not
> all of them. If you try using a module that's not present in it directly, it
> will fail. Can you please test with the patch also?

I tested the patch, and it worked well with Java SE-11 and 12 mapped to JDK 13 for modular and non modular project. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T08:29:00Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Stephan, can I bother you for a quick review for RC1? TIA! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T12:39:23Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #10)
> Stephan, can I bother you for a quick review for RC1? TIA!

looking at it now </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T13:02:24Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> For sync:

(In reply to Jay Arthanareeswaran from comment #4)
> At this point, it is impossible to cover these in new unit tests in master
> since we don't have support for all Java 13 related things. If anyone
> interested, can do so by running ModuleCompilationTest with JavaSE-12 mapped
> to JDK 13. Without patch most --release related tests will fail, but with
> the patch, there would be only three failures, which are due to some releas
> levels not supported in JDK 13.

Running on jdk-13-ea+26 the 3 failures are:
- testBug548195
- testBug548195fail
- testReleaseOption10

Tweaking AbstractCompilerTest.getPossibleComplianceLevels() to change specVersion from "13" to "12" fixes those. Good. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T13:11:05Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Next I reverted the change, and saw 13 regressions. But only accepting the changes in FileSystem fixed those.

For ClasspathJrtWithReleaseOption it is obvious that ModuleCompilationTests doesn't challenge that part, but I would have expected the change in ClasspathJep247Jdk12 to be necessary for these tests.

What would be a scenario that needs the ClasspathJep247Jdk12 change? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T13:18:15Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Change in FileSystem looks good.

Even after downloading jdk-13-ea+33 I could not find the need for the changes in ClasspathJep247Jdk12. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T13:28:27Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I _can_ reproduce the original error in a runtime workbench where only the change in FileSystem has been applied. Looking into ClasspathJrtWithReleaseOption now. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T13:56:50Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Change in ClasspathJrtWithReleaseOption.loadModules() looks good when running on JDK 13-ea+33. Trying to challenge the same code on older JDK I see that this section is not triggered on my jdk-12+33_ga, because ClasspathJrt.fs is reset to null because C/system-modules exists.

Do I need a different version of jdk-12 to reached past this fallback:
	if (jrt.fs == null || !jrt.isJRE12Plus) {
		ClasspathJrt.loadModules(jrt);
		return;
	}
?

Reason for asking: trying to figure out if the change could break below 13. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T14:06:33Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Summary so far:

* FileSystem:                   +1
* ClasspathJep247Jdk12          +0
* ClasspathJrtWithReleaseOption +1 conditionally

I could use some help on 
- why is the change in ClasspathJep247Jdk12 needed?
- how could the changed code section in ClasspathJrtWithReleaseOption possibly be triggered below 13?

@Jay?

Nitpick: In ClasspathJrtWithReleaseOption the final return FileVisitResult.SKIP_SIBLINGS looks surprising, but replacing it with CONTINUE suggests that there aren't any sibling being skipped :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T14:56:12Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #17)
> Summary so far:
> 
> * FileSystem:                   +1
> * ClasspathJep247Jdk12          +0
> * ClasspathJrtWithReleaseOption +1 conditionally

Thanks Stephan!

> I could use some help on 
> - why is the change in ClasspathJep247Jdk12 needed?

I was surprised to see that we were already iterating through all the releases there, but the problem is, the releases are iterated in anti chronological order. Which means, if a module was changed in 11 and 10, we will eventually pick the one from 10. Hence that change is useful.

> - how could the changed code section in ClasspathJrtWithReleaseOption
> possibly be triggered below 13?

All you have to do is, have a JDK 13 mapped to JavaSE-12 and use that in your project's build path. Basically the release option being used is the key. Not sure if that's what you were asking?

> @Jay?
> 
> Nitpick: In ClasspathJrtWithReleaseOption the final return
> FileVisitResult.SKIP_SIBLINGS looks surprising, but replacing it with
> CONTINUE suggests that there aren't any sibling being skipped :)

In certain cases, the release folder contain the module-info along with other packages in them. If there are any unprocessed packages after we encounter the module-info, this will help skip them. In many cases, I noticed module-info being the only entry under the module folder and those cases are unaffected.

If you are trying with a JDK 13 @ release 12, you can see all the packages inside /C/java.base/ are skipped (assuming there is no OS dependency). </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T15:20:05Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #18)
> (In reply to Stephan Herrmann from comment #17)
> > - why is the change in ClasspathJep247Jdk12 needed?
> 
> I was surprised to see that we were already iterating through all the
> releases there, but the problem is, the releases are iterated in anti
> chronological order. Which means, if a module was changed in 11 and 10, we
> will eventually pick the one from 10. Hence that change is useful.

As I'm not able to verify by debugging, let me continue the Q&A game: 

- anti-chronological order is due to our own code or accidentally due to how ct.sym is structured (today)?

- if a module is listed in - say - A/ and AB/, can those two entries possibly differ? Can an entry below AB/ be inappropriate for level A?

+ I see that inapplicable release folders are filtered out before the inner walk.

> > - how could the changed code section in ClasspathJrtWithReleaseOption
> > possibly be triggered below 13?
> 
> All you have to do is, have a JDK 13 mapped to JavaSE-12 and use that in
> your project's build path. Basically the release option being used is the
> key. Not sure if that's what you were asking?

That's what I did previously. I'm still wondering if a JDK 12 can trigger this code, or was the most part of loadModules() dead code prior to JDK 13? If "previously dead code" then there's nothing to worry. Otherwise I'd like to understand how the change affects "old" scenarios.
 
> > @Jay?
> > 
> > Nitpick: In ClasspathJrtWithReleaseOption the final return
> > FileVisitResult.SKIP_SIBLINGS looks surprising, but replacing it with
> > CONTINUE suggests that there aren't any sibling being skipped :)
> 
> In certain cases, the release folder contain the module-info along with
> other packages in them.

Then SKIP_SIBLINGS should perhaps be pulled into the "if" where we detect module-info.sig? We don't want a package to cause module-info to be skipped.

> If you are trying with a JDK 13 @ release 12, you can see all the packages
> inside /C/java.base/ are skipped (assuming there is no OS dependency).

On my system no other entries of length 3 are found. The only directory entry I see is "META-INF/". </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T15:40:11Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #19)
> 
> As I'm not able to verify by debugging, let me continue the Q&A game: 
> 
> - anti-chronological order is due to our own code or accidentally due to how
> ct.sym is structured (today)?

It's by our design. Since we are only interested in the latest release a particular class/module was changed, we do it from the latest.

> - if a module is listed in - say - A/ and AB/, can those two entries
> possibly differ? Can an entry below AB/ be inappropriate for level A?

It's unlikely that the same entry will be found both under AB and A. If it was changed in A but not in B, then it should be inside AB. If it was changed both during A and B, then it will be present inside A and B separately.

Again, it's all from my reverse engineering. May be some day I will find out it was all wrong!


> That's what I did previously. I'm still wondering if a JDK 12 can trigger
> this code, or was the most part of loadModules() dead code prior to JDK 13?
> If "previously dead code" then there's nothing to worry. Otherwise I'd like
> to understand how the change affects "old" scenarios.

The modules are cached in a static map. So, the code will be hit only the first time that particular JRT is loaded.



> > > @Jay?
> > > 
> > > Nitpick: In ClasspathJrtWithReleaseOption the final return
> > > FileVisitResult.SKIP_SIBLINGS looks surprising, but replacing it with
> > > CONTINUE suggests that there aren't any sibling being skipped :)
> > 
> > In certain cases, the release folder contain the module-info along with
> > other packages in them.
> 
> Then SKIP_SIBLINGS should perhaps be pulled into the "if" where we detect
> module-info.sig? We don't want a package to cause module-info to be skipped.

That'll be handled by the check in first if - attrs.isDirectory()


> On my system no other entries of length 3 are found. The only directory
> entry I see is "META-INF/".

This is inside the ct.sym of a JDK 13? Intersting... </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T16:13:26Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> OK, I cannot find anything wrong in the change.

While we don't have a spec for JEP 247 I cannot possibly confirm that it is correct, either.

Anyway I won't withhold my +1 any longer.



As for the order I still don't understand in which situation two entries with matching level could be at conflict, thus making order relevant.

Still please triple-check what causes the order. When I see Files.newDirectoryStream(this.releasePath) this feels like we depend on the order in the file, don't we?? This would sound like asking for yet more trouble.

Re triggering that code in ClasspathJrtWithReleaseOption below JDK 13 I'm still skeptical. For me JDK 12 always takes us into the fallback ClasspathJrt.loadModules(jrt).

And yes, ct.sym 13 seems to differ between platforms (regarding directory entries). </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T17:40:45Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #21)
> OK, I cannot find anything wrong in the change.
> 
> While we don't have a spec for JEP 247 I cannot possibly confirm that it is
> correct, either.
> 
> Anyway I won't withhold my +1 any longer.
....
> As for the order I still don't understand in which situation two entries
> with matching level could be at conflict, thus making order relevant.
> 
> Still please triple-check what causes the order. When I see
> Files.newDirectoryStream(this.releasePath) this feels like we depend on the
> order in the file, don't we?? This would sound like asking for yet more
> trouble.

Okay, I now understand why you were confused. Looks like something went wrong when I pushed the patch the second time. I meant to use the jrt.subReleases, which is why I mentioned the order is determined by us. But even that is the order determined by the system. So, regardless, what I said is not correct. And revisiting what I said, yes, there is no chance of a conflict when we consider only the relevant releases. That would mean we don't have to cache, look for duplicates etc. I will post a new patch, but I guess we should take this up for RC2. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:00:33Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Meanwhile I did another experiment: let ClasspathJrtWithReleaseOption.loadModules() throw an exception if it gets past the initial 4 lines. 

Observations:

* RunAllJDTCoreTests locally on JDK 12 has several regressions

* The test from bug 548456 is not hooked up correctly.

* This full suite stalls at about 30% with frequent OOME: Java heap space
  - I increased heap size -Xmx4g but still OOME!!
    (jenkins allocates -Xmx2G)

* So far I could not see my exception fire </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:07:33Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #21)
> Re triggering that code in ClasspathJrtWithReleaseOption below JDK 13 I'm
> still skeptical. For me JDK 12 always takes us into the fallback
> ClasspathJrt.loadModules(jrt).

Sorry, you meant without the patch? I the reason for that is why the change in FileSystem is required. Hope this clarifies.

And I have updated the patch now. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:10:15Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> "good news": OOME happens without this change, too. Even going back to M3 I see the same.

FWIW: For some (accidental) reason I'm running on 12 but with -Dcompliance=11. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:14:15Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #24)
> (In reply to Stephan Herrmann from comment #21)
> > Re triggering that code in ClasspathJrtWithReleaseOption below JDK 13 I'm
> > still skeptical. For me JDK 12 always takes us into the fallback
> > ClasspathJrt.loadModules(jrt).
> 
> Sorry, you meant without the patch?

regardless.

> the reason for that is why the change in FileSystem is required.

But with ClasspathJrtWithReleaseOption we're in a builder scenario, FileSystem (batch) is not involved. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:18:00Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #26)
> > the reason for that is why the change in FileSystem is required.
> 
> But with ClasspathJrtWithReleaseOption we're in a builder scenario,
> FileSystem (batch) is not involved.

Oops. Sorry.

And is the ClasspathJrtWithReleaseOption even constructed? Is the --release option enabled? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T18:21:24Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Jay Arthanareeswaran from comment #27)
> And is the ClasspathJrtWithReleaseOption even constructed? Is the --release
> option enabled?

You mean, I don't have to run the entire suite, just the 2 or three classes that actively set the option? Fair enough :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T19:01:24Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> After the mayhem from comment 23 I'm gradually getting back on terra firma.

Running
- 4.13 M3
- RunAllJDTCoreTests
- on JDK 11
- with -Dcompliance=11
- with -Xmx2g

The test run to completion without any OOME, and with only 2 failures.

At the same time my exception in ClasspathJrtWithReleaseOption.loadModules() did never trigger. So unless other JDK versions produce different behavior, that part was dead code prior to JDK 13. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-29T20:05:55Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I'm no longer able to reproduce any OOME, spooky why it happened and consistently so. But no blame goes on the current change.

The failures still need to be checked, but not today and not via this bug. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-08-30T04:03:26Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #29)
> At the same time my exception in ClasspathJrtWithReleaseOption.loadModules()
> did never trigger. So unless other JDK versions produce different behavior,
> that part was dead code prior to JDK 13.

I am attaching the stack that gives the path for ClasspathJrtWithReleaseOption.loadModules(). This when I run ModuleBuilderTests#testReleaseOption8() alone with JavaSE-11 mapped to a JDK 11.

Thread [main] (Suspended (breakpoint at line 77 in ClasspathJrtWithReleaseOption))	
	ClasspathJrtWithReleaseOption.<init>(String, AccessRuleSet, IPath, String) line: 77	
	ClasspathLocation.forJrtSystem(String, AccessRuleSet, IPath, String) line: 147	
	NameEnvironment.computeClasspathLocations(IWorkspaceRoot, JavaProject, SimpleLookupTable) line: 312	
	NameEnvironment.<init>(IWorkspaceRoot, JavaProject, SimpleLookupTable, BuildNotifier, CompilationGroup) line: 62	
	JavaBuilder.initializeBuilder(int, boolean) line: 650	
	JavaBuilder.build(int, Map, IProgressMonitor) line: 181 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-09-03T10:47:42Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/148527 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=c8645ac64da6ad9e7b05904f9dac2245f164a319 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-09-03T10:49:44Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #32)
> Gerrit change https://git.eclipse.org/r/148527 was merged to [master].
> Commit:
> http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/
> ?id=c8645ac64da6ad9e7b05904f9dac2245f164a319

Had an offline discussion with Jay (as he is on vacation at the time of this update) - With Stephan's review being + committed the code. Resolving - any further issues to be taken up as follow-up bugs. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2019-09-05T07:55:02Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Verified for Eclipse Version: 2019-09 (4.13) with Build id: I20190904-1805 </td> </tr>
        </table>
</body>
</html>
