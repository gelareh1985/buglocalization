<html>

<style>
html{
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif ;
    font-size: 17px;
    display: table;
}
table,th,td {
  border: 1px solid black;
  width: 1200;
  text-align:justify;
  word-break:break-all;
}

th{
background-color: lightskyblue;
font-size: 16px;
border: none;
text-align:left;
}

td{
background-color: #d5e3c8;
font-size: 14px;
}

.container {
  position: relative;
  text-align:center;
  padding-top: 70%;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: 2px solid #73AD21;
}

</style>
<body>

<h2>Bug report Information</h2>
<table>

    <th colspan="2"> Bug Report </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bug Report Number </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 560630 </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Summary </td>
        <td  style="width: 80%; background-color:#f7fff0;"> No warning on unused import on class from same package </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Creation Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2020-02-28T09:27:02Z </td>
    </tr>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Status </td>
        <td  style="width: 80%; background-color:#f7fff0;"> VERIFIED </td>
    </tr>

    <th colspan="2"> Bug Fix </th>
    <tr>
        <td  style="width: 20%; background-color:#d5e3c8;"> Bugfix Commit </td>
        <td  style="width: 80%; background-color:#f7fff0;"> Bug 562770 - NPE in at JavaSearchNameEnvironment.addModuleClassPathInfo

ClasspathLocation cp can be null so we should not call
addClassPathToModule() with cp == null.

Change-Id: Icda00fdbf74d96dc24658a5c46f211f5fa773bcd
Signed-off-by: Andrey Loskutov <loskutov@gmx.de>
 </td>
    </tr>
    <tr>
        <td  tyle="width: 20%; background-color:#d5e3c8;"> Bugfix Time </td>
        <td  style="width: 80%; background-color:#f7fff0;"> 2020-05-12T16:11:27Z </td>
    </tr>
    </table>
<table>

<th colspan="2"> Ranked List of Class Diagrams </th>

<tr>
<td  style="width: 20%; font-size: 10px; background-color:#d5e3c8">

            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Factory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SwitchExpression; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter9Test; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ClassFile; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ProblemReporter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Util; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SwitchExpressionTest; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> FormatterMassiveRegressionTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ASTConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Engine; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BindingToIndexConverter; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> PDOM; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> SelectionParser; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Factory; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractRegressionTest$JavacCompiler; </a> </li>
            </ul>   
            
            <ul>
                <li style="font-weight: bold;"> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> ModuleBuilderTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> JavadocParser; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> BTreeExpensiveTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> RunCompilerTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AbstractClassFile; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> AptBuilder; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> IField; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> WrapPreparator; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> IProblem; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> MethodBinding$LambdaMethod; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> DRLVMLauncher; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> Util; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> InfrastructureTests; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> NdMethod; </a> </li>
            </ul>   
            
            <ul>
                <li> <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" target="myIframe"> OneLineEnforcer; </a> </li>
            </ul>   
            
</td>
<td  rowspan="30" style="width: 80%;  background-color:#d5e3c8"> 
    <div class="container">
    <iframe class="responsive-iframe" src="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html" name="myIframe">
        <a href="C:/Users/gelareh/git/buglocalization/plugins/org.sidiff.bug.localization.prediction/src/webpage/image_html_pages/diagram_default.html">SELFHTML</a>
    </iframe>
    </div>
</td>
</tr>
</table>
<table>

<th colspan="2"> Ranked List of Classifiers </th>

                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.compiler.apt/Lorg/eclipse/jdt/internal/compiler/apt/model/Factory; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/SwitchExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter9Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ClassFile; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/problem/ProblemReporter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/util/Util; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/ast/CastExpression; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/SwitchExpressionTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/formatter/FormatterMassiveRegressionTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/core/dom/ASTConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/codeassist/impl/Engine; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/indexer/BindingToIndexConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/PDOM; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/AbstractASTTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/codeassist/select/SelectionParser; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.apt.core/Lorg/eclipse/jdt/apt/core/internal/util/Factory; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/indexer/ClassFileToIndexConverter; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/AbstractRegressionTest$JavacCompiler; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/codeassist/SelectionEngine; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverterJavadocTest; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/java/JavaPDOM; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/ModuleBuilderTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.compiler/Lorg/eclipse/jdt/core/tests/compiler/regression/NullReferenceImplTests~Generator; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/compiler/parser/JavadocParser; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/nd/BTreeExpensiveTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTConverter18Test; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/RunCompilerTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/model/AbstractJavaModelTests; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core/Lorg/eclipse/jdt/internal/core/pdom/db/Database; </td>
                </tr>

                
                <tr>
                    <td  style="font-size: 12px; background-color:#d5e3c8"> org.eclipse.jdt.core.tests.model/Lorg/eclipse/jdt/core/tests/dom/ASTTest; </td>
                </tr>

                </table>
<table>

<th colspan="2"> Discussion </th>

        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T09:27:02Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> package a;

public class A {

}

package a;

import a.A;
public class B extends A {

}

is ok.

package a;

import a.A;
public class C {
	public A a;
}


gives an unused import </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T09:27:36Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> this behaviour has changed very recently. is this intended? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T09:35:04Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Created attachment 281969
Sample Project </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T09:36:20Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Eclipse.org	Java Development Tools Core	3.21.0.v20200224-1648	org.eclipse.jdt.core </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T12:02:45Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Christian Dietrich from comment #1)
> this behaviour has changed very recently. is this intended?

Yes. See bug 559618. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T12:05:01Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> But why is this done half way only ? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T12:28:22Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Christian Dietrich from comment #5)
> But why is this done half way only ?

This is a different question compared to the original bug report, and yes, this is a bug.

The behavior is not new in 4.15 (I see it in 4.12), but bug 559618 supposed to have a fix for that.

-------------------
package a;
public class A {
}

package a;
import a.A; // no warning for unused import!
public class B extends A {
}
------------------- </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T22:50:38Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Pierre-Yves, do you want to tackle this part, too?

Are there more call paths leading to smth like
  importReference.bits |= ASTNode.Used
? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-28T22:53:12Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #7)
> Pierre-Yves, do you want to tackle this part, too?
> 
> Are there more call paths leading to smth like
>   importReference.bits |= ASTNode.Used
> ?

Yes, I can probably give it a go! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-02-29T21:34:16Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/158625 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-03-31T21:52:14Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> oops, this slipped my attention, setting a milestone to remind me. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-04-05T21:09:38Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Sorry, we ran out of time for 4.16 M1, moving to M3 (since M2 is not a defined milestone, just on I-build that is contributed to Eclipse 2020-06), hoping to get to this soon. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-10T15:53:17Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #9)
> New Gerrit change created: https://git.eclipse.org/r/158625

This looks OK for this particular issue, but I still see a number of copies of 
											importReference.bits |= ASTNode.Used;

which are not protected by the new check (see also comment 7).

Can you argue, why those are not relevant, or do you want to wait for one new bug for each occurrence? :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-11T17:48:07Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> I can s(In reply to Stephan Herrmann from comment #12)
> (In reply to Eclipse Genie from comment #9)
> > New Gerrit change created: https://git.eclipse.org/r/158625
> 
> This looks OK for this particular issue, but I still see a number of copies
> of 
> 											importReference.bits |= ASTNode.Used;
> 
> which are not protected by the new check (see also comment 7).
> 
> Can you argue, why those are not relevant, or do you want to wait for one
> new bug for each occurrence? :)

I can see 6 occurrences of ASTNode used in Scope.java. After a quick analysis, I've come to the following conclusions. Using the line numbers as of change 158625 patch set 5:
* line 2237: this is for statically imported fields, which, if I'm not mistaken, are not impacted by any same package behaviour.
* line 2265: this is for statically imported fields, which, if I'm not mistaken, are not impacted by any same package behaviour.
* line 2781: this is for statically imported methods, which, if I'm not mistaken, are not impacted by any same package behaviour.
* line 3418: case covered by Bug 559618.
* line 3449: case covered by this bug.
* line 3497: this is for "on demand imports" (== wildcard import if my understanding is correct?). Case covered by Bug 31628.

And as you said, we can fix missed edge cases in future bug reports. As long as we don't start introducing a load of false positives, I like the idea of iteratively and incrementally improving things :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-12T16:36:14Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Pierre-Yves B. from comment #13)
> I can see 6 occurrences of ASTNode used in Scope.java. After a quick
> analysis, I've come to the following conclusions. Using the line numbers as
> of change 158625 patch set 5:
> * line 2237: this is for statically imported fields, which, if I'm not
> mistaken, are not impacted by any same package behaviour.
> * line 2265: this is for statically imported fields, which, if I'm not
> mistaken, are not impacted by any same package behaviour.
> * line 2781: this is for statically imported methods, which, if I'm not
> mistaken, are not impacted by any same package behaviour.
> * line 3418: case covered by Bug 559618.
> * line 3449: case covered by this bug.
> * line 3497: this is for "on demand imports" (== wildcard import if my
> understanding is correct?). Case covered by Bug 31628.

Thanks for the analysis. Much appreciated.

> And as you said, we can fix missed edge cases in future bug reports. As long
> as we don't start introducing a load of false positives, I like the idea of
> iteratively and incrementally improving things :)

It's a balance: if "iterative and incremental" results in perceivable inconsistency is will confuse users. See

(In reply to Christian Dietrich from comment #5)
> But why is this done half way only ?


It may also be harder to pick up the ball several months later. So, each commit should be mature on its own right, but there will always be chances to improve in the future :)

I rebased the change and plan to release after jenkins's +1. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-12T18:36:53Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/158625 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=d404ac773e545304cc49cb032fa354e7aee43b4f </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-12T18:38:06Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Eclipse Genie from comment #15)
> Gerrit change https://git.eclipse.org/r/158625 was merged to [master].
> Commit:
> http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/
> ?id=d404ac773e545304cc49cb032fa354e7aee43b4f

Released to master for 4.16 M3

Thanks, Pierre-Yves </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T05:34:26Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/162922 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T05:35:08Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/162923 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T05:35:50Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/162924 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T05:37:02Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> New Gerrit change created: https://git.eclipse.org/r/162925 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T05:54:37Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/162924 was merged to [master].
Commit: http://git.eclipse.org/c/platform/eclipse.platform.debug.git/commit/?id=84fc28ba536ab34a5311e337134fc5d0e13e00c8 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T06:16:03Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/162922 was merged to [master].
Commit: http://git.eclipse.org/c/platform/eclipse.platform.ui.git/commit/?id=24600c1cb861ebcee0ae96dd7c427652adaa985f </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T06:21:27Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/162925 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=ea9eb8e53fa30cbe88c7d852c6ad1d52995fa1e5 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-13T06:44:05Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Gerrit change https://git.eclipse.org/r/162923 was merged to [master].
Commit: http://git.eclipse.org/c/jdt/eclipse.jdt.ui.git/commit/?id=6a077c355b901921066892db1f1e3abe5a53e112 </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T12:06:54Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #16)
> (In reply to Eclipse Genie from comment #15)
> > Gerrit change https://git.eclipse.org/r/158625 was merged to [master].
> > Commit:
> > http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/
> > ?id=d404ac773e545304cc49cb032fa354e7aee43b4f
> 
> Released to master for 4.16 M3
> 
> Thanks, Pierre-Yves

We see a bad compiler regression in compilation of our internal code due this.

I'm trying to provide a standalone example, but the "innocent" code is not compiling anymore with absolutely weird error messages.

The file below (sorry not standalone example yet) was compiling fine since ever, now doesn't.

We are using Java 8 JLS and compile against Java 8 OpenJDK and no fancy compilation arguments, pretty much standard.

Code that doesn't compile:

/*
 * generated by Xtext 2.21.0
 */
package com.advantest.itee.tpl.validation;

import com.advantest.itee.tpl.validation.specification.ActionValidation;
import com.advantest.itee.tpl.validation.specification.InstrumentValidation;
import com.advantest.itee.tpl.validation.specification.LiteralValidation;
import com.advantest.itee.tpl.validation.specification.ModeValidation;
import com.advantest.itee.tpl.validation.specification.OptionsValidation;
import com.advantest.itee.tpl.validation.specification.ParameterAndValuesValidation;
import com.advantest.itee.tpl.validation.specification.PortValidation;
import com.advantest.itee.tpl.validation.specification.PropertyValidation;
import com.advantest.itee.tpl.validation.specification.ProtocolValidation;
import com.advantest.itee.tpl.validation.specification.SetValidation;
import com.advantest.itee.tpl.validation.specification.SignalGroupValidation;
import com.advantest.itee.tpl.validation.specification.SignalLinkValidation;
import com.advantest.itee.tpl.validation.specification.VariableValidation;
import com.advantest.itee.tpl.validation.specification.WaveformValidation;
import com.advantest.itee.tpl.validation.specification.WavetableValidation;
import com.advantest.itee.tpl.validation.testflow.CharacterizationValidator;
import java.util.ArrayList;
import java.util.List;
import org.eclipse.emf.ecore.EPackage;
import org.eclipse.xtext.validation.AbstractDeclarativeValidator;
import org.eclipse.xtext.validation.ComposedChecks;

@ComposedChecks(validators = {ImportValidation.class, TplDutboardValidator.class, TplSpecValidator.class, ActionValidation.class, InstrumentValidation.class, LiteralValidation.class, ModeValidation.class, OptionsValidation.class, PortValidation.class, PropertyValidation.class, ProtocolValidation.class, SetValidation.class, SignalGroupValidation.class, SignalLinkValidation.class, VariableValidation.class, WaveformValidation.class, WavetableValidation.class, ParameterAndValuesValidation.class, TplIpBlockValidator.class, TplTestProgramValidator.class, TplOperatingSequenceValidator.class, TestProgramVariableValidation.class, TplInstrumentModelValidator.class, TplFlowValidator.class, TplPackageValidator.class, TplTestSuiteValidator.class, CharacterizationValidator.class, TplIndexAccessAndAssignmentValidator.class, TplExpressionValidator.class, TplNoSideEffectValidator.class})
public abstract class AbstractTplValidator extends AbstractDeclarativeValidator {
	
	@Override
	protected List<EPackage> getEPackages() {
		List<EPackage> result = new ArrayList<EPackage>();
		result.add(EPackage.Registry.INSTANCE.getEPackage("http://www.advantest.com/itee/tpl/Tpl"));
		result.add(EPackage.Registry.INSTANCE.getEPackage("http://www.eclipse.org/emf/2002/Ecore"));
		return result;
	}
}

The errors are all on the long annotations line and it complains about *some* annotation classes (and here the fun starts):

Type mismatch: cannot convert from Class<ActionValidation> to Class<? extends AbstractDeclarativeValidator> 
Type mismatch: cannot convert from Class<CharacterizationValidator> to Class<? extends AbstractDeclarativeValidator>    
Type mismatch: cannot convert from Class<InstrumentValidation> to Class<? extends AbstractDeclarativeValidator> 
Type mismatch: cannot convert from Class<LiteralValidation> to Class<? extends AbstractDeclarativeValidator>    
Type mismatch: cannot convert from Class<ModeValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<OptionsValidation> to Class<? extends AbstractDeclarativeValidator>    
Type mismatch: cannot convert from Class<ParameterAndValuesValidation> to Class<? extends AbstractDeclarativeValidator> 
Type mismatch: cannot convert from Class<PortValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<PropertyValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<ProtocolValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<SetValidation> to Class<? extends AbstractDeclarativeValidator>    
Type mismatch: cannot convert from Class<SignalGroupValidation> to Class<? extends AbstractDeclarativeValidator>    
Type mismatch: cannot convert from Class<SignalLinkValidation> to Class<? extends AbstractDeclarativeValidator> 
Type mismatch: cannot convert from Class<VariableValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<WaveformValidation> to Class<? extends AbstractDeclarativeValidator>   
Type mismatch: cannot convert from Class<WavetableValidation> to Class<? extends AbstractDeclarativeValidator> 

*Everything else* is compilable. Switching JDT back to commit 91e063ba131d7041233f08bdf4acbe4a50602366 fixes the errors.

I would appreciate if we could fix or revert this ASAP, because our "rolling" SDK build that we use to validate 4.16 against our internal tests is not working anymore. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T13:13:35Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Created https://git.eclipse.org/r/#/c/163099/

I'm feeling lucky / wish me luck.

"Normally", I would wait for a standalone reproducer, but I have the feeling that this could be fixed based on the experience that invocation of getAnnotationTagBits() can badly disturb compilation order.

@Pierre-Yves: please try to remember, why you added this call.

Background: annotation-related tagBits are computed lazily via getAnnotationTagBits() (which may require resolving(!) annotations(!) - perhaps ahead of their time). Other tagBits, however, are set eagerly when creating a binding or such. TagBits.IsNestedType should be in the second group. Am I missing anything? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T13:27:04Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #26)
> Created https://git.eclipse.org/r/#/c/163099/
> 
> I'm feeling lucky / wish me luck.
> 
> "Normally", I would wait for a standalone reproducer, but I have the feeling
> that this could be fixed based on the experience that invocation of
> getAnnotationTagBits() can badly disturb compilation order.

That works. I'm unable to produce a standalone example from the code I have, it is a spaghetti of xtend generated code with some bits of Java in three different source folders in one big project and all based on Xtext. Can we merge nevertheless? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T13:31:27Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #26)
> @Pierre-Yves: please try to remember, why you added this call.

The reason is probably very simple: I spotted TagBits.IsNestedType before noticing that a isNestedType() method existed, and therefore used it as I didn't know any better! :) </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T13:31:59Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Andrey Loskutov from comment #27)
> (In reply to Stephan Herrmann from comment #26)
> > Created https://git.eclipse.org/r/#/c/163099/
> > 
> > I'm feeling lucky / wish me luck.
> > 
> > "Normally", I would wait for a standalone reproducer, but I have the feeling
> > that this could be fixed based on the experience that invocation of
> > getAnnotationTagBits() can badly disturb compilation order.
> 
> That works. I'm unable to produce a standalone example from the code I have,
> it is a spaghetti of xtend generated code with some bits of Java in three
> different source folders in one big project and all based on Xtext. Can we
> merge nevertheless?

I can make an exception regarding a test case, but shouldn't we still wait for jenkins to reply? Or is jenkins unhealthy from some other virus? I see plenty of recent failures related to releng issues?? </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T13:34:05Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Pierre-Yves B. from comment #28)
> (In reply to Stephan Herrmann from comment #26)
> > @Pierre-Yves: please try to remember, why you added this call.
> 
> The reason is probably very simple: I spotted TagBits.IsNestedType before
> noticing that a isNestedType() method existed, and therefore used it as I
> didn't know any better! :)

Thanks. And you probably didn't see the isNestedType() method because imprecise type of 'resolvedImport'. Good to know that there was no hidden intention. </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T16:47:09Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Fix for regression reported in comment 25 was merged as https://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/?id=26ed2eeed70be007d0d75c31379cc16a0c6c4ed2

Thanks, Andrey, for reporting the regression! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-15T16:53:10Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> (In reply to Stephan Herrmann from comment #31)
> Fix for regression reported in comment 25 was merged as
> https://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/
> ?id=26ed2eeed70be007d0d75c31379cc16a0c6c4ed2
> 
> Thanks, Andrey, for reporting the regression!

Thank you Stephan for fast fix, that saved me a weekend for sure! </td> </tr>
        
        <tr>
            <td style="width: 20%; font-size: 12px; background-color:#d5e3c8"> Creation Time </td>
            <td style="width: 80%; font-size: 12px; background-color:#d5e3c8"> 2020-05-19T11:19:20Z </td>
        </tr>
        <tr> <td colspan="2" style="font-size: 12px; background-color:#f7fff0"> Verified for 4.16 M3 using build I20200518-2220 </td> </tr>
        </table>
</body>
</html>
